<ion-header>
	<ion-toolbar>
		<ion-buttons slot="start">
			<ion-back-button></ion-back-button>
		</ion-buttons>
	</ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
	<ion-card class="m-0 p-0 ion-padding">
		<ion-grid>
			<ion-row class="mt-4 mb-5">
				<ion-col>
					<ion-label class="pl-2 pr-2 fs-35">2009</ion-label>
					<ion-label class="pl-2 pr-2 fs-35">K-5</ion-label>
					<ion-label class="pl-2 pr-2">12K1234</ion-label>
				</ion-col>
			</ion-row>
			<ion-row>
				<ion-col>
					<ion-label>{{'home_ongoing_detail.max' | translate}}</ion-label>
					<br />
					<ion-label *ngIf="max" class="fs-15"
						><strong>￦{{max | number}}</strong></ion-label
					>
				</ion-col>
				<ion-col>
					<ion-label>{{'home_ongoing_detail.average' | translate}}</ion-label>
					<br />
					<ion-label *ngIf="average" class="fs-15"
						><strong>￦{{average | number}}</strong></ion-label
					>
				</ion-col>
				<ion-col>
					<ion-label>{{'home_ongoing_detail.min' | translate}}</ion-label>
					<br />
					<ion-label *ngIf="min" class="fs-15"
						><strong>￦{{min | number}}</strong></ion-label
					>
				</ion-col>
			</ion-row>
		</ion-grid>
	</ion-card>

	<ion-item-group class="mt-8 text-center" *ngIf="!participants">
		<ion-label>
			<ion-skeleton-text animated></ion-skeleton-text>
		</ion-label>
		<ion-item-sliding *ngFor="let item of participants">
			<ion-item>
				<ion-avatar slot="start">
					<ion-skeleton-text animated></ion-skeleton-text>
				</ion-avatar>
				<ion-label>
					<h2>
						<ion-skeleton-text animated></ion-skeleton-text>
					</h2>
					<p class="fs-25">
						<ion-skeleton-text animated></ion-skeleton-text>
					</p>
				</ion-label>
				<ion-note slot="end">
					<ion-skeleton-text animated></ion-skeleton-text>
				</ion-note>
				<ion-icon slot="end" name="chevron-back-outline"></ion-icon>
			</ion-item>
		</ion-item-sliding>
	</ion-item-group>

	<ion-item-group
		class="mt-4"
		*ngIf="selectedDealer && checkArray() && ongoing.participants.length === 2"
	>
		<ion-title class="text-center mb-4">
			A Dealer has confirm the purchase
		</ion-title>
		<ion-card lines="none" class="text-center">
			<img class="mt-4" src="../../../../../assets/images/photos/OBC8OG0.jpg" />
			<ion-card-header class="bar-rating">
				<bar-rating
					*ngIf="selectedDealer.dealer?.averStar"
					[(ngModel)]="selectedDealer.dealer.averStar"
					[max]="5"
					[theme]="'fontawesome'"
					class="not-active"
				>
				</bar-rating>
			</ion-card-header>
			<ion-card-content>
				<p class="fs-20">{{selectedDealer.dealer?.email}}</p>
				<p class="fs-20">￦{{selectedDealer.price | number}}</p>
			</ion-card-content>
		</ion-card>
	</ion-item-group>

	<ion-item-group
		class="mt-8"
		*ngIf="!selectedDealer && participants && ongoing.effectedTime <= now && ongoing.expiredTime > now"
	>
		<ion-label style="line-height: normal">Dealer Preview</ion-label>
		<ion-item
			lines="none"
			*ngFor="let item of participants"
			(click)="getDealerDetail(item.id, item.userId)"
		>
			<ion-avatar slot="start">
				<img src="../../../../../assets/images/photos/31887.jpg" />
			</ion-avatar>
			<ion-label>
				<p class="fs-20" style="line-height: normal">{{item.dealer?.email}}</p>
				<p class="fs-20">￦{{item.price | number}}</p>
				<bar-rating
					*ngIf="item.dealer?.averStar"
					[(ngModel)]="item.dealer.averStar"
					[max]="5"
					[theme]="'fontawesome'"
					class="not-active"
				>
				</bar-rating>
			</ion-label>
		</ion-item>
	</ion-item-group>

	<ion-item-group
		class="mt-8"
		*ngIf="!selectedDealer && participants && ongoing.effectedTime < now && ongoing.expiredTime < now"
	>
		<ion-label style="line-height: normal"
			>{{'home_ongoing_detail.select_dealer' | translate}}</ion-label
		>
		<ion-item-sliding *ngFor="let item of participants">
			<ion-item lines="none" (click)="getDealerDetail(item.id, item.userId)">
				<ion-avatar slot="start">
					<img src="../../../../../assets/images/photos/31887.jpg" />
				</ion-avatar>
				<ion-label>
					<p class="fs-20" style="line-height: normal">
						{{item.dealer?.email}}
					</p>
					<p class="fs-20">￦{{item.price | number}}</p>
					<bar-rating
						[(ngModel)]="item.dealer.averStar"
						[max]="5"
						[theme]="'fontawesome'"
						class="not-active"
					>
					</bar-rating>
				</ion-label>
				<ion-icon slot="end" name="chevron-back-outline"></ion-icon>
			</ion-item>
			<ion-item-options side="end">
				<ion-item-option (click)="selectDealer(item.id)">
					Select
				</ion-item-option>
			</ion-item-options>
		</ion-item-sliding>
	</ion-item-group>

	<ion-item-group
		class="mt-4"
		*ngIf="selectedDealer && participants.length >= 1 && !checkArray()"
	>
		<ion-title class="text-center mb-4" style="line-height: normal"
			>Waiting for Dealer Confirmation</ion-title
		>
		<ion-card lines="none" class="text-center">
			<img class="mt-4" src="../../../../../assets/images/photos/OBC8OG0.jpg" />
			<ion-card-header class="bar-rating">
				<bar-rating
					*ngIf="selectedDealer.dealer?.averStar"
					[(ngModel)]="selectedDealer.dealer.averStar"
					[max]="5"
					[theme]="'fontawesome'"
					class="not-active"
				>
				</bar-rating>
			</ion-card-header>
			<ion-card-content>
				<p class="fs-20">{{selectedDealer.dealer?.email}}</p>
				<p class="fs-20">￦{{selectedDealer.price | number}}</p>
			</ion-card-content>
		</ion-card>
	</ion-item-group>
</ion-content>

<ion-footer
	class="ion-padding"
	*ngIf="selectedDealer && checkArray() && ongoing.participants.length === 2"
>
	<ion-button
		expand="full"
		color="tertiary"
		[routerLink]="['/','home','visit',id]"
		>To visit page
	</ion-button>
</ion-footer>
